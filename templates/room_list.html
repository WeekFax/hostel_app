{% extends "base.html" %}
{% load static %}

{% block nav_navbar_nav %}
  <li><a href="/">Главная</a></li>
  <li class="active"><a href="/rooms">Комнаты</a></li>
  <li><a href="/students">Студенты</a></li>            
  <li><a href="/hostels">Общежития</a></li>

{% endblock %}

{% block stuff %}
  <div class="row">
    <div class='col-md-3'>
      <div class='row-form well'>
        <button class="btn btn-large btn-primary btn-block" type="button">Добавить комнату</button>
      </div>
      <form class="well">      
        <div class="form-group">
          <label for="inputNumber" class="col-form-label">Номер комнаты</label>
          <input name='room' type="text" class="form-control" id="inputnumber" value={{ request.room }}>
        </div>
        <fieldset class="form-group">
          <label class="col-form-label">Кол-во спальных мест</label>
          <div class="form-row">  
            <div class="col-md-1">
              <div style="padding-top: 5px;" class="col-form-label">От:</div>  
            </div>
            <div class="col-md-4">      
              <input name='spaceFrom' style="padding-left: 5px; padding-right: 0px;" type="number" class="form-control" id="inputNumberFrom" value={{ request.spaceFrom }} placeholder=0>
            </div>
            <div class="col-md-1">
              <div style="padding-top: 5px;" class="col-form-label">До:</div>  
            </div>
            <div class="col-md-4">
              <input name='spaceTo' style="padding-left: 5px; padding-right: 0px;"  type="number" class="form-control" id="inputNumberTo" value={{ request.spaceTo }} placeholder=10>
            </div>
          </div>
        </fieldset>

        <fieldset class="form-group">
          <label class="col-form-label">Кол-во свободных мест</label>
          <div class="form-row">            
            <div class="col-md-1">
              <div style="padding-top: 5px;" class="col-form-label">От:</div>  
            </div>
            <div class="col-md-10">
              <input name='freeSpace' style="padding-left: 5px; padding-right: 0px;"  type="number" class="form-control" id="inputFreeNumber" value={{ request.freeSpace }} placeholder=0>
            </div>
          </div>
        </fieldset>

        <div class="form-group col">
          <label for="inputState">Общежитие</label>
          <select name='hostel' id="inputState" class="form-control">
            {% if request.hostel == "-1" %}
            <option selected value="-1"></option>
            {% else %}
            <option value="-1"></option>
            {% endif %}
            {% for host in Hostels %}
                  {% if request.hostel ==  host.id|stringformat:"i"  %}
                  <option selected value="{{ host.id }}">{{ host.name }}</option>
                  {% else %}
                  <option value="{{ host.id }}">{{ host.name }}</option>
                  {% endif %}                
            {% endfor %}
          </select>
        </div>

        <div class="form-group col">
          <label for="inputState">Тип комнаты</label>
          <select name='type' id="inputState" class="form-control">
            {% if request.type == "-1" %}
            <option selected value="-1"></option>
            {% else %}
            <option value="-1"></option>
            {% endif %}
            {% for t in Types %}
                  {% if request.type ==  t.id|stringformat:"i"  %}
                  <option selected value="{{ t.id }}">{{ t.name }}</option>
                  {% else %}
                  <option value="{{ t.id }}">{{ t.name }}</option>
                  {% endif %}                
            {% endfor %}
          </select>
        </div>
        
        <div class="form-group row">
          <div class="col-md-10">
            <button type="submit" class="btn btn-primary">Найти</button>
          </div>
        </div>
      </form>
    </div>

    <div class="col-md-9">
      <div class="row row-main">
        {% for room in Rooms %}
          <div class="col-sm-12 col-lg-12 col-md-12 item-object">
            <div class="thumbnail">
              <div class="dropdown pull-right">
                <button class="btn dropdown-toggle" type="button" data-toggle="dropdown">
                  <span class="glyphicon glyphicon-option-vertical" aria-hidden="true"></span>
                </button>
                <ul class="dropdown-menu">
                  <li>
                    <form method="get" action="/products/{{ room.id }}/edit">
                      <input type="hidden" name="_method" value="edit">
                      <button class="btn-link" type="submit">Изменить</button>
                    </form>
                  </li>
                  <li>
                    <form method="post" action="/products/{{ room.id }}/delete">{% csrf_token %}
                      <input type="hidden" name="_method" value="delete">
                      <button class="btn-link" type="submit">Удалить</button>
                    </form>
                </ul>
              </div>
              <div class="caption">
                <h3  style="margin-top: 10px;">{{ room.name }}</h3>
                <p>Номер комнаты: {{room.room_number}}</br>
                Общежитие: {{room.hostel_name}}</br>
                Адрес: {{room.hostel_address}}</br>
                Тип комнаты: {{room.room_type}}</br>
                Всего мест: {{room.count_place}}</br>
                Свободных мест: {{room.free_space}}</br>
                Проживающие студенты: {{room.students}}</br></p>
              </div>
            </div>
          </div>
        {% endfor %}
      </div>


      <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          {% if Rooms.has_previous %}
            <li class="page-item"><a class="page-link" href="?{{ request_str }}page={{ Rooms.previous_page_number }}">Назад</a></li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">Назад</span></li>
          {% endif %}
          {% for page_num in pages_list %}
            {% if page_num == Rooms.number|stringformat:"i" %}
              <li class="page-item disabled"><span class="page-link">{{page_num}}</span></li>
            {% else %}
              <li class="page-item"><a class="page-link" href="?{{ request_str }}page={{page_num}}">{{page_num}}</a></li>
            {% endif %}
          {% endfor %}
          {% if Rooms.has_next %}
            <li class="page-item"><a class="page-link" href="?{{ request_str }}page={{ Rooms.next_page_number }}">Далее</a></li>
          {% else %}
            <li class="page-item disabled"><span class="page-link">Далее</span></li>
          {% endif %}
        </ul>
      </nav>

      
    </div>

  </div>
{% endblock %}